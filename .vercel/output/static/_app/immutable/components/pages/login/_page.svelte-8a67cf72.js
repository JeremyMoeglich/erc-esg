import{S as pe,i as _e,s as ge,k as $,w as J,a as D,q as Z,l as y,m as P,x as M,h as w,c as O,r as G,n as T,p as te,b as L,D as g,y as U,E as de,ab as he,f as N,d as we,u as ue,t as q,z as F,a1 as ve,T as ne,_ as be,$ as ke,a0 as $e,g as ye,Z as Pe}from"../../../chunks/index-8132481b.js";import{g as se}from"../../../chunks/navigation-93d63568.js";import{p as Ee}from"../../../chunks/stores-88328872.js";import{B as ae}from"../../../chunks/button-e8e119c3.js";import{I as Ae}from"../../../chunks/input_field-cec05477.js";import{c as Re}from"../../../chunks/auth_state-7a238df3.js";import{t as ce,U as Ne}from"../../../chunks/token_login-8de4a6c4.js";import{m as K}from"../../../chunks/index-1d5742ea.js";import{i as oe}from"../../../chunks/loading_store-b28525d0.js";import{t as re}from"../../../chunks/index-afe3ebdb.js";async function je(e,n){const{token:t}=K.object({token:K.string()}).parse(await(await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:n})})).json());await ce(t,!1)}async function Ie(e,n,t){const{token:o}=K.object({token:K.string()}).parse(await(await fetch("/auth/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:n,password:t})})).json());await ce(o,!1)}function ie(e,n,t){const o=e.slice();o[11]=n[t];const i=o[11][1].type;o[12]=i;const l=o[11][0];return o[13]=l,o}function Se(e){let n;return{c(){n=Z("Registrieren")},l(t){n=G(t,"Registrieren")},m(t,o){L(t,n,o)},d(t){t&&w(n)}}}function Be(e){let n;return{c(){n=Z("Anmelden")},l(t){n=G(t,"Anmelden")},m(t,o){L(t,n,o)},d(t){t&&w(n)}}}function le(e){let n,t,o;function i(a){e[8](a,e[13])}let l={text:e[13],autocomplete:e[11][1].autocomplete,type:e[12],placeholder:`Hier ${e[13]} eingeben...`};return e[1][e[13]]!==void 0&&(l.value=e[1][e[13]]),n=new Ae({props:l}),be.push(()=>ke(n,"value",i)),{c(){J(n.$$.fragment)},l(a){M(n.$$.fragment,a)},m(a,h){U(n,a,h),o=!0},p(a,h){e=a;const r={};h&1&&(r.text=e[13]),h&1&&(r.autocomplete=e[11][1].autocomplete),h&1&&(r.type=e[12]),h&1&&(r.placeholder=`Hier ${e[13]} eingeben...`),!t&&h&11&&(t=!0,r.value=e[1][e[13]],$e(()=>t=!1)),n.$set(r)},i(a){o||(N(n.$$.fragment,a),o=!0)},o(a){q(n.$$.fragment,a),o=!1},d(a){F(n,a)}}}function fe(e){let n,t,o;return{c(){n=$("p"),t=$("mark"),o=Z(e[2])},l(i){n=y(i,"P",{});var l=P(n);t=y(l,"MARK",{});var a=P(t);o=G(a,e[2]),a.forEach(w),l.forEach(w)},m(i,l){L(i,n,l),g(n,t),g(t,o)},p(i,l){l&4&&ue(o,i[2])},d(i){i&&w(n)}}}function De(e){let n,t,o,i,l,a,h,r,j,I,E,b,p,v,V=e[0]==="login"?"Noch keinen Account?":"Bereits ein Account?",H,Q,A,C,W,Y;i=new Ne({props:{size:32}});function x(s,u){if(s[0]==="login")return Be;if(s[0]==="register")return Se}let S=x(e),d=S&&S(e),R=re(e[3][e[0]]),f=[];for(let s=0;s<R.length;s+=1)f[s]=le(ie(e,R,s));const me=s=>q(f[s],1,1,()=>{f[s]=null});let m=e[2]&&fe(e);return b=new ae({props:{text:e[0]==="login"?"Anmelden":"Registrieren",important:!0,onclick:e[4]}}),A=new ae({props:{text:e[0]==="login"?"Registrieren":"Anmelden",onclick:e[9]}}),{c(){n=$("div"),t=$("div"),o=$("div"),J(i.$$.fragment),l=D(),a=$("h3"),d&&d.c(),h=D(),r=$("form");for(let s=0;s<f.length;s+=1)f[s].c();j=D(),m&&m.c(),I=D(),E=$("div"),J(b.$$.fragment),p=D(),v=$("p"),H=Z(V),Q=D(),J(A.$$.fragment),this.h()},l(s){n=y(s,"DIV",{class:!0});var u=P(n);t=y(u,"DIV",{class:!0});var _=P(t);o=y(_,"DIV",{class:!0});var B=P(o);M(i.$$.fragment,B),B.forEach(w),l=O(_),a=y(_,"H3",{});var c=P(a);d&&d.l(c),c.forEach(w),h=O(_),r=y(_,"FORM",{class:!0});var k=P(r);for(let X=0;X<f.length;X+=1)f[X].l(k);j=O(k),m&&m.l(k),I=O(k),E=y(k,"DIV",{class:!0});var ee=P(E);M(b.$$.fragment,ee),ee.forEach(w),k.forEach(w),p=O(_),v=y(_,"P",{class:!0});var z=P(v);H=G(z,V),Q=O(z),M(A.$$.fragment,z),z.forEach(w),_.forEach(w),u.forEach(w),this.h()},h(){T(o,"class","avatar svelte-1ewt7kf"),T(E,"class","btn svelte-1ewt7kf"),T(r,"class","inputs svelte-1ewt7kf"),te(r,"--distance",e[0]==="login"?"25px":"0px"),T(v,"class","register svelte-1ewt7kf"),T(t,"class","main svelte-1ewt7kf"),T(n,"class","outer svelte-1ewt7kf")},m(s,u){L(s,n,u),g(n,t),g(t,o),U(i,o,null),g(t,l),g(t,a),d&&d.m(a,null),g(t,h),g(t,r);for(let _=0;_<f.length;_+=1)f[_].m(r,null);g(r,j),m&&m.m(r,null),g(r,I),g(r,E),U(b,E,null),g(t,p),g(t,v),g(v,H),g(v,Q),U(A,v,null),C=!0,W||(Y=de(r,"submit",he(e[7])),W=!0)},p(s,[u]){if(S!==(S=x(s))&&(d&&d.d(1),d=S&&S(s),d&&(d.c(),d.m(a,null))),u&11){R=re(s[3][s[0]]);let c;for(c=0;c<R.length;c+=1){const k=ie(s,R,c);f[c]?(f[c].p(k,u),N(f[c],1)):(f[c]=le(k),f[c].c(),N(f[c],1),f[c].m(r,j))}for(ye(),c=R.length;c<f.length;c+=1)me(c);we()}s[2]?m?m.p(s,u):(m=fe(s),m.c(),m.m(r,I)):m&&(m.d(1),m=null);const _={};u&1&&(_.text=s[0]==="login"?"Anmelden":"Registrieren"),b.$set(_),u&1&&te(r,"--distance",s[0]==="login"?"25px":"0px"),(!C||u&1)&&V!==(V=s[0]==="login"?"Noch keinen Account?":"Bereits ein Account?")&&ue(H,V);const B={};u&1&&(B.text=s[0]==="login"?"Registrieren":"Anmelden"),u&1&&(B.onclick=s[9]),A.$set(B)},i(s){if(!C){N(i.$$.fragment,s);for(let u=0;u<R.length;u+=1)N(f[u]);N(b.$$.fragment,s),N(A.$$.fragment,s),C=!0}},o(s){q(i.$$.fragment,s),f=f.filter(Boolean);for(let u=0;u<f.length;u+=1)q(f[u]);q(b.$$.fragment,s),q(A.$$.fragment,s),C=!1},d(s){s&&w(n),F(i),d&&d.d(),ve(f,s),m&&m.d(),F(b),F(A),W=!1,Y()}}}function Oe(e,n,t){let o,i;ne(e,Re,p=>t(5,o=p)),ne(e,Ee,p=>t(6,i=p));let l="login";const a={"Passwort wiederholen":"",Email:"",Passwort:"",Name:""},h={login:{Email:{type:"email",autocomplete:"email"},Passwort:{type:"password",autocomplete:"current-password"}},register:{Email:{type:"email",autocomplete:"email"},Passwort:{type:"password",autocomplete:"new-password"},Name:{type:"text",autocomplete:"name"},"Passwort wiederholen":{type:"password",autocomplete:"new-password"}}};let r="";async function j(){if(l==="register"&&a.Passwort!==a["Passwort wiederholen"]){t(2,r="Passw\xF6rter stimmen nicht \xFCberein.");return}try{oe.set(!0);const p=l==="login"?await je(a.Email,a.Passwort):await Ie(a.Name,a.Email,a.Passwort);p===void 0?await se("/"):t(2,r=p.message)}finally{oe.set(!1)}}function I(p){Pe.call(this,e,p)}function E(p,v){e.$$.not_equal(a[v],p)&&(a[v]=p,t(1,a))}const b=()=>{l==="login"?t(0,l="register"):t(0,l="login")};return e.$$.update=()=>{e.$$.dirty&64&&t(0,l=i.url.searchParams.has("register")?"register":"login"),e.$$.dirty&32&&o!=="none"&&se("/")},[l,a,r,h,j,o,i,I,E,b]}class Ke extends pe{constructor(n){super(),_e(this,n,Oe,De,ge,{})}}export{Ke as default};

import{S as O,i as S,s as U,L as C,M as N,N as P,m as b,h as _,n as d,O as W,b as k,D as E,P as ne,B as D,Q as F,R as G,q as re,r as le,u as ae,U as R,e as J,T as ee,k as v,l as w,W as Q,a as te,c as ie,p as Z,g as A,t as p,d as L,f as g,Y as K,Z as se,w as I,x as M,y as q,z as V,E as j,a7 as oe,a8 as ce,I as fe}from"./index-8132481b.js";import{a as ue}from"./auth_state-7a238df3.js";import{w as _e}from"./index-674a61bc.js";import{m as T}from"./index-1d5742ea.js";import{C as de}from"./ArrowUp.svelte_svelte_type_style_lang-c73ae56d.js";const z=_e({}),me=r=>new Promise((e,t)=>{const i=new FileReader;i.readAsDataURL(r),i.onload=()=>e(i.result),i.onerror=n=>t(n)});async function he(r,e){if(console.log("upload_image",r,e),!e.type.startsWith("image/"))return Promise.reject(new Error("Invalid file type"));const t=await fetch("/api/upload_image",{method:"POST",body:JSON.stringify({image:await me(e),id:r}),headers:{"Content-Type":"application/json"}}),{image_url:i}=T.object({image_url:T.string()}).parse(await t.json());return i}function X(r){let e,t;return{c(){e=N("title"),t=re(r[1])},l(i){e=P(i,"title",{});var n=b(e);t=le(n,r[1]),n.forEach(_)},m(i,n){k(i,e,n),E(e,t)},p(i,n){n&2&&ae(t,i[1])},d(i){i&&_(e)}}}function ge(r){let e,t,i=r[1]&&X(r),n=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:r[0]},{height:r[0]},r[2],r[3]],a={};for(let l=0;l<n.length;l+=1)a=C(a,n[l]);return{c(){e=N("svg"),i&&i.c(),t=N("path"),this.h()},l(l){e=P(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var s=b(e);i&&i.l(s),t=P(s,"path",{d:!0}),b(t).forEach(_),s.forEach(_),this.h()},h(){d(t,"d","M2 26H30V28H2zM25.4 9c.8-.8.8-2 0-2.8 0 0 0 0 0 0l-3.6-3.6c-.8-.8-2-.8-2.8 0 0 0 0 0 0 0l-15 15V24h6.4L25.4 9zM20.4 4L24 7.6l-3 3L17.4 7 20.4 4zM6 22v-3.6l10-10 3.6 3.6-10 10H6z"),W(e,a)},m(l,s){k(l,e,s),i&&i.m(e,null),E(e,t)},p(l,[s]){l[1]?i?i.p(l,s):(i=X(l),i.c(),i.m(e,t)):i&&(i.d(1),i=null),W(e,a=ne(n,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},s&1&&{width:l[0]},s&1&&{height:l[0]},s&4&&l[2],s&8&&l[3]]))},i:D,o:D,d(l){l&&_(e),i&&i.d()}}}function pe(r,e,t){let i,n;const a=["size","title"];let l=F(e,a),{size:s=16}=e,{title:o=void 0}=e;return r.$$set=f=>{t(5,e=C(C({},e),G(f))),t(3,l=F(e,a)),"size"in f&&t(0,s=f.size),"title"in f&&t(1,o=f.title)},r.$$.update=()=>{t(4,i=e["aria-label"]||e["aria-labelledby"]||o),t(2,n={"aria-hidden":i?void 0:!0,role:i?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=G(e),[s,o,n,l,i]}class be extends O{constructor(e){super(),S(this,e,pe,ge,U,{size:0,title:1})}}async function ve(r){let e=R(z);if(r in e)return e[r];const t=`/api/images/${r}.json`,i=await fetch(t),{image_url:n}=T.object({image_url:T.string()}).parse(await i.json());return e=R(z),z.set({...e,[r]:n}),n}function $(r){let e,t;return{c(){e=v("img"),this.h()},l(i){e=w(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Q(e.src,t=`${r[2][r[0]]}?tr=${r[1]}`)||d(e,"src",t),d(e,"alt",r[0]),d(e,"class","svelte-roua6y")},m(i,n){k(i,e,n)},p(i,n){n&7&&!Q(e.src,t=`${i[2][i[0]]}?tr=${i[1]}`)&&d(e,"src",t),n&1&&d(e,"alt",i[0])},d(i){i&&_(e)}}}function we(r){var i;let e,t=((i=r[2])==null?void 0:i[r[0]])&&$(r);return{c(){t&&t.c(),e=J()},l(n){t&&t.l(n),e=J()},m(n,a){t&&t.m(n,a),k(n,e,a)},p(n,[a]){var l;(l=n[2])!=null&&l[n[0]]?t?t.p(n,a):(t=$(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:D,o:D,d(n){t&&t.d(n),n&&_(e)}}}function ke(r,e,t){let i;ee(r,z,s=>t(2,i=s));let{id:n}=e,{attr:a=""}=e;async function l(s){{const o=await ve(s);if(o instanceof Error)throw o}}return r.$$set=s=>{"id"in s&&t(0,n=s.id),"attr"in s&&t(1,a=s.attr)},r.$$.update=()=>{r.$$.dirty&1&&l(n)},[n,a,i]}class H extends O{constructor(e){super(),S(this,e,ke,we,U,{id:0,attr:1})}}function ye(r){let e,t,i;return t=new H({props:{id:r[0],attr:r[2]}}),{c(){e=v("div"),I(t.$$.fragment)},l(n){e=w(n,"DIV",{});var a=b(e);M(t.$$.fragment,a),a.forEach(_)},m(n,a){k(n,e,a),q(t,e,null),i=!0},p(n,a){const l={};a&1&&(l.id=n[0]),a&4&&(l.attr=n[2]),t.$set(l)},i(n){i||(g(t.$$.fragment,n),i=!0)},o(n){p(t.$$.fragment,n),i=!1},d(n){n&&_(e),V(t)}}}function Ee(r){let e,t,i;return t=new H({props:{id:r[0],attr:r[2]}}),{c(){e=v("a"),I(t.$$.fragment),this.h()},l(n){e=w(n,"A",{href:!0,"data-sveltekit-prefetch":!0});var a=b(e);M(t.$$.fragment,a),a.forEach(_),this.h()},h(){d(e,"href",r[1]),d(e,"data-sveltekit-prefetch","")},m(n,a){k(n,e,a),q(t,e,null),i=!0},p(n,a){const l={};a&1&&(l.id=n[0]),a&4&&(l.attr=n[2]),t.$set(l),(!i||a&2)&&d(e,"href",n[1])},i(n){i||(g(t.$$.fragment,n),i=!0)},o(n){p(t.$$.fragment,n),i=!1},d(n){n&&_(e),V(t)}}}function ze(r){let e,t,i,n,a;return t=new H({props:{id:r[0],attr:r[2]}}),{c(){e=v("button"),I(t.$$.fragment)},l(l){e=w(l,"BUTTON",{});var s=b(e);M(t.$$.fragment,s),s.forEach(_)},m(l,s){k(l,e,s),q(t,e,null),i=!0,n||(a=j(e,"click",function(){oe(r[1])&&r[1].apply(this,arguments)}),n=!0)},p(l,s){r=l;const o={};s&1&&(o.id=r[0]),s&4&&(o.attr=r[2]),t.$set(o)},i(l){i||(g(t.$$.fragment,l),i=!0)},o(l){p(t.$$.fragment,l),i=!1},d(l){l&&_(e),V(t),n=!1,a()}}}function x(r){let e,t,i,n;const a=[Ie,De],l=[];function s(o,f){return o[3]?1:0}return t=s(r),i=l[t]=a[t](r),{c(){e=v("div"),i.c(),this.h()},l(o){e=w(o,"DIV",{class:!0});var f=b(e);i.l(f),f.forEach(_),this.h()},h(){d(e,"class","overlay svelte-ncddq1"),K(e,"loading",r[3])},m(o,f){k(o,e,f),l[t].m(e,null),n=!0},p(o,f){let c=t;t=s(o),t===c?l[t].p(o,f):(A(),p(l[c],1,1,()=>{l[c]=null}),L(),i=l[t],i?i.p(o,f):(i=l[t]=a[t](o),i.c()),g(i,1),i.m(e,null)),(!n||f&8)&&K(e,"loading",o[3])},i(o){n||(g(i),n=!0)},o(o){p(i),n=!1},d(o){o&&_(e),l[t].d()}}}function De(r){let e,t;return e=new de({}),{c(){I(e.$$.fragment)},l(i){M(e.$$.fragment,i)},m(i,n){q(e,i,n),t=!0},p:D,i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){p(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function Ie(r){let e,t,i,n,a,l,s,o;return i=new be({props:{size:24}}),{c(){e=v("div"),t=v("div"),I(i.$$.fragment),n=te(),a=v("input"),this.h()},l(f){e=w(f,"DIV",{class:!0});var c=b(e);t=w(c,"DIV",{class:!0});var u=b(t);M(i.$$.fragment,u),u.forEach(_),n=ie(c),a=w(c,"INPUT",{type:!0,class:!0}),c.forEach(_),this.h()},h(){d(t,"class","edit_file_symbol svelte-ncddq1"),d(a,"type","file"),d(a,"class","svelte-ncddq1"),d(e,"class","edit_file_input svelte-ncddq1")},m(f,c){k(f,e,c),E(e,t),q(i,t,null),E(e,n),E(e,a),l=!0,s||(o=[j(a,"change",r[10]),j(a,"change",r[7]),j(a,"click",ce(r[9]))],s=!0)},p:D,i(f){l||(g(i.$$.fragment,f),l=!0)},o(f){p(i.$$.fragment,f),l=!1},d(f){f&&_(e),V(i),s=!1,fe(o)}}}function Me(r){let e,t,i,n,a,l;const s=[ze,Ee,ye],o=[];function f(u,m){return typeof u[1]=="function"?0:typeof u[1]=="string"?1:2}i=f(r),n=o[i]=s[i](r);let c=r[6]&&x(r);return{c(){e=v("div"),t=v("div"),n.c(),a=te(),c&&c.c(),this.h()},l(u){e=w(u,"DIV",{class:!0});var m=b(e);t=w(m,"DIV",{class:!0});var y=b(t);n.l(y),y.forEach(_),a=ie(m),c&&c.l(m),m.forEach(_),this.h()},h(){d(t,"class","content svelte-ncddq1"),d(e,"class","outer svelte-ncddq1"),Z(e,"width",r[5])},m(u,m){k(u,e,m),E(e,t),o[i].m(t,null),E(e,a),c&&c.m(e,null),l=!0},p(u,[m]){let y=i;i=f(u),i===y?o[i].p(u,m):(A(),p(o[y],1,1,()=>{o[y]=null}),L(),n=o[i],n?n.p(u,m):(n=o[i]=s[i](u),n.c()),g(n,1),n.m(t,null)),u[6]?c?(c.p(u,m),m&64&&g(c,1)):(c=x(u),c.c(),g(c,1),c.m(e,null)):c&&(A(),p(c,1,1,()=>{c=null}),L()),m&32&&Z(e,"width",u[5])},i(u){l||(g(n),g(c),l=!0)},o(u){p(n),p(c),l=!1},d(u){u&&_(e),o[i].d(),c&&c.d()}}}function qe(r,e,t){let i,n;ee(r,ue,h=>t(6,n=h));let{id:a}=e,{click:l=void 0}=e,{width:s=void 0}=e,{attr:o=""}=e,f=!1,c;async function u(){if(c&&c.length>0){if(c.length>1)throw new Error("Too many files");try{t(3,f=!0);const h=c[0],B=await he(a,h);if(B instanceof Error)throw B;const Y=R(z);Y[a]=B,z.set(Y)}finally{t(3,f=!1)}}}function m(h){se.call(this,r,h)}function y(){c=this.files,t(4,c)}return r.$$set=h=>{"id"in h&&t(0,a=h.id),"click"in h&&t(1,l=h.click),"width"in h&&t(8,s=h.width),"attr"in h&&t(2,o=h.attr)},r.$$.update=()=>{r.$$.dirty&256&&t(5,i=typeof s=="number"?`${s}px`:s)},[a,l,o,f,c,i,n,u,s,m,y]}class Ne extends O{constructor(e){super(),S(this,e,qe,Me,U,{id:0,click:1,width:8,attr:2})}}export{Ne as D,z as i};

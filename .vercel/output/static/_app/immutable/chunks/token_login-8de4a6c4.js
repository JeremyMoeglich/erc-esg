import{S as B,i as E,s as I,L as p,M as d,N as h,m,h as f,n as k,O as b,b as U,D as v,P as M,B as A,Q as j,R,q as z,r as O,u as D}from"./index-8132481b.js";import{c as S}from"./auth_state-7a238df3.js";import{u as Z}from"./user_data-73545cb4.js";import{m as g}from"./index-1d5742ea.js";import{s as F}from"./datatypes-f51f27d5.js";/*! js-cookie v3.0.1 | MIT */function u(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)n[o]=i[o]}return n}var P={read:function(n){return n[0]==='"'&&(n=n.slice(1,-1)),n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(n){return encodeURIComponent(n).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function w(n,e){function i(t,l,a){if(!(typeof document>"u")){a=u({},e,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var s in a)!a[s]||(r+="; "+s,a[s]!==!0&&(r+="="+a[s].split(";")[0]));return document.cookie=t+"="+n.write(l,t)+r}}function o(t){if(!(typeof document>"u"||arguments.length&&!t)){for(var l=document.cookie?document.cookie.split("; "):[],a={},r=0;r<l.length;r++){var s=l[r].split("="),c=s.slice(1).join("=");try{var _=decodeURIComponent(s[0]);if(a[_]=n.read(c,_),t===_)break}catch{}}return t?a[t]:a}}return Object.create({set:i,get:o,remove:function(t,l){i(t,"",u({},l,{expires:-1}))},withAttributes:function(t){return w(this.converter,u({},this.attributes,t))},withConverter:function(t){return w(u({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(n)}})}var C=w(P,{path:"/"});function T(){return C.get("login_token")}function q(n){C.set("login_token",n)}function Y(){C.remove("login_token")}function x(n){let e,i;return{c(){e=d("title"),i=z(n[1])},l(o){e=h(o,"title",{});var t=m(e);i=O(t,n[1]),t.forEach(f)},m(o,t){U(o,e,t),v(e,i)},p(o,t){t&2&&D(i,o[1])},d(o){o&&f(e)}}}function H(n){let e,i,o,t=n[1]&&x(n),l=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],a={};for(let r=0;r<l.length;r+=1)a=p(a,l[r]);return{c(){e=d("svg"),t&&t.c(),i=d("path"),o=d("path"),this.h()},l(r){e=h(r,"svg",{xmlns:!0,viewBox:!0,fill:!0,preserveAspectRatio:!0,width:!0,height:!0});var s=m(e);t&&t.l(s),i=h(s,"path",{d:!0}),m(i).forEach(f),o=h(s,"path",{d:!0}),m(o).forEach(f),s.forEach(f),this.h()},h(){k(i,"d","M16,8a5,5,0,1,0,5,5A5,5,0,0,0,16,8Zm0,8a3,3,0,1,1,3-3A3.0034,3.0034,0,0,1,16,16Z"),k(o,"d","M16,2A14,14,0,1,0,30,16,14.0158,14.0158,0,0,0,16,2ZM10,26.3765V25a3.0033,3.0033,0,0,1,3-3h6a3.0033,3.0033,0,0,1,3,3v1.3765a11.8989,11.8989,0,0,1-12,0Zm13.9925-1.4507A5.0016,5.0016,0,0,0,19,20H13a5.0016,5.0016,0,0,0-4.9925,4.9258,12,12,0,1,1,15.985,0Z"),b(e,a)},m(r,s){U(r,e,s),t&&t.m(e,null),v(e,i),v(e,o)},p(r,[s]){r[1]?t?t.p(r,s):(t=x(r),t.c(),t.m(e,i)):t&&(t.d(1),t=null),b(e,a=M(l,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},s&1&&{width:r[0]},s&1&&{height:r[0]},s&4&&r[2],s&8&&r[3]]))},i:A,o:A,d(r){r&&f(e),t&&t.d()}}}function J(n,e,i){let o,t;const l=["size","title"];let a=j(e,l),{size:r=16}=e,{title:s=void 0}=e;return n.$$set=c=>{i(5,e=p(p({},e),R(c))),i(3,a=j(e,l)),"size"in c&&i(0,r=c.size),"title"in c&&i(1,s=c.title)},n.$$.update=()=>{i(4,o=e["aria-label"]||e["aria-labelledby"]||s),i(2,t={"aria-hidden":o?void 0:!0,role:o?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=R(e),[r,s,t,a,o]}class X extends B{constructor(e){super(),E(this,e,J,H,I,{size:0,title:1})}}async function K(){const n=T();if(!!n)try{await L(n)}catch(e){if(e instanceof Error&&e.message!=="Invalid token")throw e}}async function L(n,e=!0){if(e){const t=await fetch("/auth/token_login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n})}).catch(a=>a),{valid:l}=g.object({valid:g.boolean()}).parse(await t.json());if(!l)throw Y(),new Error("Invalid token")}q(n);const i=await(await fetch("/api/get_own_user_data")).json(),{user_data:o}=g.object({user_data:F}).parse(i);Z.set(o),S.set(o.role)}export{X as U,K as c,T as g,Y as r,L as t};
